{
  "type": "object",
  "title": "Table configuration",
  "required": ["base_id", "destination"],
  "properties": {
    "base_id": {
      "type": "string",
      "enum": [],
      "title": "Base ID",
      "format": "select",
      "description": "The ID of the Airtable base where the table is located.",
      "propertyOrder": 1,
      "options": {
        "tags": true,
        "creatable": true
      }
    },
    "load_bases": {
      "type": "button",
      "format": "sync-action",
      "propertyOrder": 2,
      "options": {
        "async": {
          "label": "LOAD BASES",
          "action": "list_bases"
        }
      }
    },
    "destination": {
      "type": "object",
      "title": "Destination",
      "required": ["table_name", "columns", "load_type"],
      "propertyOrder": 3,
      "properties": {
        "table_name": {
          "type": "string",
          "enum": [],
          "title": "Table Name",
          "format": "select",
          "description": "The name of the table to be created/updated in the specified base.",
          "propertyOrder": 1,
          "options": {
            "tags": true,
            "creatable": true
          }
        },
        "load_tables": {
          "type": "button",
          "format": "sync-action",
          "propertyOrder": 2,
          "options": {
            "async": {
              "label": "LOAD TABLES",
              "action": "list_tables"
            }
          }
        },
        "load_type": {
          "enum": ["Append", "Full Load", "Incremental Load"],
          "type": "string",
          "title": "Load Type",
          "default": "Append",
          "description": "Full Load: Delete all rows and reload from scratch;\nIncremental Load: Update existing records using primary keys;\nAppend: Add new records without checking for duplicates.",
          "propertyOrder": 3
        },
        "columns": {
          "type": "array",
          "items": {
            "type": "object",
            "title": "Column",
            "required": ["source_name", "destination_name"],
            "properties": {
              "source_name": {
                "type": "string",
                "title": "Source Column",
                "watch": {
                  "columns": "_metadata_.table.columns"
                },
                "enumSource": "columns",
                "propertyOrder": 1
              },
              "destination_name": {
                "type": "string",
                "title": "Destination Column",
                "propertyOrder": 2
              },
              "pk": {
                "type": "boolean",
                "title": "Primary Key",
                "format": "checkbox",
                "default": false,
                "propertyOrder": 3
              },
              "dtype": {
                "enum": [
                  "barcode",
                  "checkbox",
                  "currency",
                  "date",
                  "dateTime",
                  "email",
                  "multilineText",
                  "multipleSelects",
                  "number",
                  "percent",
                  "phoneNumber",
                  "rating",
                  "richText",
                  "singleLineText",
                  "singleSelect",
                  "url"
                ],
                "type": "string",
                "title": "Airtable Field Type",
                "default": "singleLineText",
                "propertyOrder": 4
              }
            }
          },
          "title": "Columns",
          "format": "table",
          "propertyOrder": 4
        }
      }
    }
  },
  "_metadata_": {
    "type": "object",
    "options": {
      "hidden": true
    },
    "properties": {
      "table": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "columns": {
            "type": "array"
          },
          "primaryKey": {
            "type": "array"
          }
        }
      }
    }
  }
}
