{
  "type": "object",
  "title": "Table configuration",
  "required": [
    "base_id",
    "destination"
  ],
  "properties": {
    "base_id": {
      "enum": [],
      "type": "string",
      "title": "Base ID",
      "format": "select",
      "options": {
        "async": {
          "label": "LOAD BASES",
          "action": "list_bases",
          "autoload": []
        }
      },
      "description": "The ID of the Airtable base where the table is located.",
      "propertyOrder": 1
    },
    "destination": {
      "type": "object",
      "title": "Destination",
      "required": [
        "table_name",
        "columns",
        "load_type"
      ],
      "propertyOrder": 2,
      "properties": {
        "table_name": {
          "enum": [],
          "type": "string",
          "title": "Table Name or Table ID",
          "format": "select",
          "description": "The name/id of the table to be created/updated in the specified base.",
          "propertyOrder": 1,
          "options": {
            "async": {
              "label": "LOAD TABLES",
              "action": "list_tables",
              "autoload": [
                "parameters.base_id"
              ]
            }
          }
        },
        "load_type": {
          "enum": [
            "Append",
            "Full Load",
            "Incremental Load"
          ],
          "type": "string",
          "title": "Load Type",
          "default": "Append",
          "description": "Full Load: Delete all rows and reload from scratch; Incremental Load: Update existing records using primary keys; Append: Add new records without checking for duplicates.",
          "propertyOrder": 2
        },
        "columns": {
          "type": "array",
          "items": {
            "type": "object",
            "title": "Column",
            "required": [
              "source_name",
              "destination_name"
            ],
            "properties": {
              "source_name": {
                "type": "string",
                "title": "Source Column",
                "enumSource": "columns",
                "propertyOrder": 1
              },
              "destination_name": {
                "type": "string",
                "title": "Destination Column",
                "propertyOrder": 2
              },
              "pk": {
                "type": "boolean",
                "title": "Primary Key",
                "format": "checkbox",
                "default": false,
                "propertyOrder": 3
              },
              "dtype": {
                "enum": [
                  "barcode",
                  "checkbox",
                  "currency",
                  "date",
                  "dateTime",
                  "email",
                  "multilineText",
                  "multipleSelects",
                  "number",
                  "percent",
                  "phoneNumber",
                  "rating",
                  "richText",
                  "singleLineText",
                  "singleSelect",
                  "url"
                ],
                "type": "string",
                "title": "Airtable Field Type",
                "default": "singleLineText",
                "propertyOrder": 4
              }
            }
          },
          "title": "Columns",
          "format": "table",
          "propertyOrder": 3
        },
        "load_columns_button":{
          "type":"button",
          "format":"sync-action",
          "propertyOrder":4,
          "options": {
            "async": {
              "cache":false,
              "label": "LOAD COLUMNS",
              "action": "return_columns_data",
              "autoload": [
                "parameters.destination.table_name"
              ]
            }
          }
        }
      }
    },
    "_metadata_": {
      "type": "object",
      "options": {
        "hidden": true
      }
    }
  }
}